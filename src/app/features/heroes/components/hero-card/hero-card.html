<mat-card class="hero-card" 
          [class.deceased]="!hero().isAlive"
          (click)="onCardClick()">
  
  <mat-card-header>
    <div mat-card-avatar class="hero-card-avatar">
      @if (hero().imageUrl) {
        <img
          [src]="hero().imageUrl"
          [alt]="hero().name"
          (error)="onImageError($event)"
        />
      } @else {
        <img src="images/not_image.png" [alt]="hero().name" />
      }
    </div>

    <mat-card-title class="hero-card-title">
      {{ hero().name }}
      <mat-chip
        [class]="hero().isAlive ? 'status-alive' : 'status-dead'"
        class="status-chip"
      >
        <mat-icon>{{
          hero().isAlive ? "favorite" : "heart_broken"
        }}</mat-icon>
      </mat-chip>
    </mat-card-title>

    @if (hero().realName) {
      <mat-card-subtitle>{{ hero().realName }}</mat-card-subtitle>
    }
  </mat-card-header>

  <mat-card-content>
    <div class="card-effectiveness">
      <span class="effectiveness-label">Effectiveness</span>
      <div class="effectiveness-display">
        <mat-progress-bar mode="determinate" [value]="hero().effectiveness">
        </mat-progress-bar>
        <span class="effectiveness-percentage">{{ hero().effectiveness }}%</span>
      </div>
    </div>

    <div class="card-powers">
      <span class="powers-label">Powers</span>
      <mat-chip-set>
        @for (power of hero().powers.slice(0, 3); track power) {
          <mat-chip class="power-chip">{{ power }}</mat-chip>
        }
        @if (hero().powers.length > 3) {
          <mat-chip
            class="more-chip"
            [matTooltip]="getMorePowersTooltip(hero().powers.slice(3))"
          >
            +{{ hero().powers.length - 3 }}
          </mat-chip>
        }
      </mat-chip-set>
    </div>

    @if (hero().weaknesses.length > 0) {
      <div class="card-weaknesses">
        <span class="weaknesses-label">Weaknesses</span>
        <mat-chip-set>
          @for (weakness of hero().weaknesses.slice(0, 2); track weakness) {
            <mat-chip class="weakness-chip">{{ weakness }}</mat-chip>
          }
          @if (hero().weaknesses.length > 2) {
            <mat-chip
              class="more-chip"
              [matTooltip]="getMoreWeaknessesTooltip(hero().weaknesses.slice(2))"
            >
              +{{ hero().weaknesses.length - 2 }}
            </mat-chip>
          }
        </mat-chip-set>
      </div>
    }
  </mat-card-content>

  <mat-card-actions align="end">
    <button
      mat-button
      color="primary"
      (click)="onHeroAction('view', $event)"
    >
      <mat-icon>visibility</mat-icon>
      View
    </button>

    <button
      mat-button
      color="accent"
      (click)="onHeroAction('edit', $event)"
    >
      <mat-icon>edit</mat-icon>
      Edit
    </button>

    <button
      mat-button
      color="warn"
      (click)="onHeroAction('delete', $event)"
    >
      <mat-icon>delete</mat-icon>
      Delete
    </button>
  </mat-card-actions>
</mat-card>